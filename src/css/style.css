:root {
  --ink:#0f1f14; --forest:#1a4d2e; --canopy:#2e7d52; --leaf:#4caf72;
  --mint:#a8e6be; --mist:#e8f5ed; --cream:#f7faf8;
  --amber:#e8963a; --ember:#f4c97e; --sky:#5bc4d4;
  --text-muted:#6b8f76; --border:#daeee1;
  --shadow:0 4px 24px rgba(30,90,50,.10);
  --shadow-lg:0 12px 48px rgba(30,90,50,.16);
  --r:16px; --r-lg:24px; --r-xl:36px;
  --sidebar:260px;
}
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;overflow:hidden}
body{font-family:'DM Sans',sans-serif;background:var(--cream);color:var(--ink)}

/* ===== LAYOUT ===== */
.shell{display:grid;grid-template-columns:var(--sidebar) 1fr;height:100vh;overflow:hidden}

/* ===== SIDEBAR ===== */
.sidebar{
  background:var(--ink);color:white;
  display:flex;flex-direction:column;padding:28px 0 24px;
  overflow:hidden;
}
.brand{padding:0 24px 28px;border-bottom:1px solid rgba(255,255,255,.08);margin-bottom:8px}
.brand-logo{
  width:44px;height:44px;border-radius:14px;
  background:linear-gradient(135deg,var(--leaf),var(--canopy));
  display:flex;align-items:center;justify-content:center;font-size:22px;
  box-shadow:0 4px 16px rgba(76,175,114,.4);margin-bottom:12px;
}
.brand-name{font-family:'Fraunces',serif;font-size:18px;font-weight:600;letter-spacing:-.5px;color:white}
.brand-sub{font-size:11px;color:rgba(255,255,255,.4);font-weight:500;letter-spacing:.5px;text-transform:uppercase;margin-top:2px}

.nav{flex:1;padding:0 12px;display:flex;flex-direction:column;gap:2px}
.nav-item{
  display:flex;align-items:center;gap:12px;padding:11px 14px;
  border-radius:12px;cursor:pointer;transition:all .2s;
  font-size:13.5px;font-weight:500;color:rgba(255,255,255,.5);
  border:none;background:transparent;font-family:'DM Sans',sans-serif;
  text-align:left;width:100%;
}
.nav-item:hover{background:rgba(255,255,255,.07);color:rgba(255,255,255,.85)}
.nav-item.active{background:var(--forest);color:var(--mint)}
.nav-icon{font-size:18px;width:24px;text-align:center;flex-shrink:0}

.sidebar-streak{
  margin:0 12px;padding:14px;
  background:linear-gradient(135deg,var(--forest),#1a3d2a);
  border-radius:14px;border:1px solid rgba(76,175,114,.2);
}
.streak-fire{font-size:24px;margin-bottom:4px}
.streak-num{font-family:'Space Mono',monospace;font-size:28px;font-weight:700;color:var(--ember);line-height:1}
.streak-label{font-size:11px;color:rgba(255,255,255,.5);margin-top:2px;font-weight:500}

/* ===== MAIN ===== */
.main{overflow-y:auto;overflow-x:hidden;height:100vh;scroll-behavior:smooth}

/* ===== VIEWS ===== */
.view{display:none;animation:fadeUp .35s ease}
.view.active{display:block}
@keyframes fadeUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

/* ===== HERO ===== */
.hero{
  background:linear-gradient(160deg,var(--forest) 0%,var(--canopy) 65%,var(--leaf) 100%);
  padding:40px 28px 80px;position:relative;overflow:hidden;
}
.hero::after{
  content:'';position:absolute;bottom:-1px;left:0;right:0;height:48px;
  background:var(--cream);clip-path:ellipse(55% 100% at 50% 100%);
}
.hero-pattern{
  position:absolute;inset:0;pointer-events:none;
  background-image:radial-gradient(circle at 80% 20%, rgba(168,230,190,.15) 0%, transparent 50%),
    radial-gradient(circle at 20% 80%, rgba(30,90,50,.3) 0%, transparent 50%);
}
.hero-label{color:rgba(255,255,255,.6);font-size:12px;font-weight:500;letter-spacing:1px;text-transform:uppercase;margin-bottom:4px}
.hero-title{font-family:'Fraunces',serif;font-size:26px;font-weight:600;color:white;line-height:1.2}
.hero-title em{font-style:italic;font-weight:300;color:var(--mint)}

.hero-stats{display:flex;gap:12px;margin-top:24px;position:relative;z-index:1}
.stat-card{
  flex:1;background:rgba(255,255,255,.12);backdrop-filter:blur(12px);
  border:1px solid rgba(255,255,255,.18);border-radius:var(--r-lg);
  padding:16px;text-align:center;
}
.stat-ring-wrap{position:relative;width:80px;height:80px;margin:0 auto 8px}
.stat-ring-wrap svg{transform:rotate(-90deg)}
.ring-bg{stroke:rgba(255,255,255,.15)}
.ring-fill{stroke:var(--mint);stroke-linecap:round;transition:stroke-dashoffset 1.5s cubic-bezier(.16,1,.3,1);filter:drop-shadow(0 0 8px rgba(168,230,190,.6))}
.ring-num{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-family:'Space Mono',monospace;font-size:22px;font-weight:700;color:white}
.stat-label{font-size:10px;font-weight:600;color:rgba(255,255,255,.7);text-transform:uppercase;letter-spacing:.5px}

.impact-card{
  flex:1;background:rgba(255,255,255,.12);backdrop-filter:blur(12px);
  border:1px solid rgba(255,255,255,.18);border-radius:var(--r-lg);padding:16px;
}
.impact-row{display:flex;align-items:center;gap:10px;padding:6px 0}
.impact-row+.impact-row{border-top:1px solid rgba(255,255,255,.1)}
.impact-emoji{font-size:20px;flex-shrink:0}
.impact-val{font-family:'Space Mono',monospace;font-size:16px;font-weight:700;color:white;line-height:1.1}
.impact-desc{font-size:10px;color:rgba(255,255,255,.6)}

/* ===== AI TIP ===== */
.tip-float{margin:-44px 20px 0;position:relative;z-index:5;margin-bottom:8px}
.tip-card{
  background:linear-gradient(135deg,#fffbef,white);
  border:1.5px solid var(--ember);border-radius:var(--r-lg);
  padding:16px 18px;display:flex;gap:14px;align-items:flex-start;
  box-shadow:0 4px 20px rgba(232,150,58,.15);
}
.tip-bulb{
  width:36px;height:36px;border-radius:10px;
  background:linear-gradient(135deg,var(--ember),var(--amber));
  display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;
}
.tip-header{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--amber);margin-bottom:4px}
.tip-text{font-size:13px;color:var(--ink);line-height:1.65}
.tip-loading{display:flex;gap:5px;align-items:center;padding:4px 0}
.dot{width:6px;height:6px;border-radius:50%;background:var(--amber);animation:pulse 1.2s ease-in-out infinite}
.dot:nth-child(2){animation-delay:.2s}.dot:nth-child(3){animation-delay:.4s}
@keyframes pulse{0%,100%{opacity:.3;transform:scale(.7)}50%{opacity:1;transform:scale(1)}}

/* ===== SECTION LAYOUT ===== */
.section-pad{padding:16px 20px}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px}

/* ===== CARD ===== */
.card{background:white;border-radius:var(--r-lg);padding:20px;border:1px solid var(--border);box-shadow:var(--shadow)}
.card-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.card-title{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text-muted)}
.badge-pill{display:inline-flex;align-items:center;gap:4px;background:var(--mist);color:var(--canopy);font-size:10px;font-weight:700;padding:4px 10px;border-radius:999px}
.badge-pill.up{background:#e8f8f0;color:#1e7a4b}
.badge-pill.down{background:#fef2e8;color:#c45f0a}

/* ===== CHART ===== */
.chart-bars{display:flex;gap:6px;align-items:flex-end;height:90px;padding:2px 0}
.bar-wrap{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;justify-content:flex-end;height:100%}
.bar{
  width:100%;border-radius:6px 6px 0 0;
  transition:height .9s cubic-bezier(.16,1,.3,1);
  cursor:pointer;position:relative;
  min-height:4px;
}
.bar.good{background:linear-gradient(180deg,var(--mint),var(--leaf))}
.bar.ok{background:linear-gradient(180deg,#ffd166,var(--amber))}
.bar.bad{background:linear-gradient(180deg,#ff9da7,#e05562)}
.bar:hover::after{
  content:attr(data-tip);position:absolute;bottom:calc(100% + 6px);left:50%;transform:translateX(-50%);
  background:var(--ink);color:white;font-size:10px;padding:4px 8px;border-radius:6px;white-space:nowrap;
  font-family:'Space Mono',monospace;z-index:10;
}
.bar-day{font-size:9px;font-weight:600;color:var(--text-muted)}

/* ===== PROGRESS ===== */
.prog-label{display:flex;justify-content:space-between;font-size:11.5px;color:var(--text-muted);margin-bottom:7px;font-weight:500}
.prog-track{height:10px;background:var(--mist);border-radius:999px;overflow:hidden}
.prog-fill{height:100%;background:linear-gradient(90deg,var(--mint),var(--leaf));border-radius:999px;transition:width 1.2s cubic-bezier(.16,1,.3,1);position:relative;overflow:hidden}
.prog-fill::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.4),transparent);animation:shimmer 2s infinite}
@keyframes shimmer{from{transform:translateX(-100%)}to{transform:translateX(200%)}}

/* ===== BADGES ===== */
.badges-row{display:flex;gap:10px;overflow-x:auto;padding:2px 0;scrollbar-width:none}
.badges-row::-webkit-scrollbar{display:none}
.badge-item{flex-shrink:0;text-align:center;width:64px}
.badge-icon{
  width:52px;height:52px;border-radius:14px;
  display:flex;align-items:center;justify-content:center;font-size:24px;
  margin:0 auto 6px;transition:transform .2s;
}
.badge-icon:hover{transform:scale(1.1) rotate(-6deg)}
.badge-icon.earned{background:linear-gradient(135deg,var(--mist),#c6f0d6);border:2px solid var(--leaf)}
.badge-icon.locked{background:#f4f4f4;border:2px dashed #d5d5d5;filter:grayscale(1);opacity:.45}
.badge-name{font-size:9px;font-weight:600;color:var(--text-muted);line-height:1.3}

/* ===== LEADERBOARD ===== */
.rank-row{display:flex;align-items:center;gap:12px;padding:10px 0;border-bottom:1px solid var(--mist)}
.rank-row:last-child{border-bottom:none}
.rank-n{width:28px;font-family:'Space Mono',monospace;font-size:12px;font-weight:700;color:var(--text-muted);text-align:center;flex-shrink:0}
.rank-n.g{color:#f5a623}.rank-n.s{color:#9ba8b5}.rank-n.b{color:#c47d3e}
.rank-avatar{width:38px;height:38px;border-radius:50%;background:var(--mist);display:flex;align-items:center;justify-content:center;font-size:17px;flex-shrink:0}
.rank-info{flex:1}
.rank-name{font-size:13.5px;font-weight:600;color:var(--ink)}
.rank-sub{font-size:10.5px;color:var(--text-muted)}
.rank-score{font-family:'Space Mono',monospace;font-size:16px;font-weight:700;color:var(--canopy)}
.rank-row.me{background:linear-gradient(135deg,var(--mist),#d4f5df);border-radius:12px;padding:10px 12px;margin:2px -6px}

/* ===== LOG FORM ===== */
.form-hero{background:linear-gradient(135deg,var(--leaf),var(--canopy));padding:44px 24px 28px}
.form-hero h1{font-family:'Fraunces',serif;color:white;font-size:24px;font-weight:600}
.form-hero p{color:rgba(255,255,255,.7);font-size:13px;margin-top:4px}

.form-section{padding:20px;margin-bottom:4px}
.section-label{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text-muted);margin-bottom:12px;display:flex;align-items:center;gap:8px}

.opt-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:20px}
.opt-btn{
  background:white;border:2px solid var(--border);border-radius:14px;
  padding:12px 8px;text-align:center;cursor:pointer;transition:all .2s;
  font-family:'DM Sans',sans-serif;
}
.opt-emoji{font-size:24px;display:block;margin-bottom:4px}
.opt-label{font-size:10px;font-weight:600;color:var(--text-muted)}
.opt-btn:hover{border-color:var(--mint);background:var(--mist)}
.opt-btn.sel{background:var(--mist);border-color:var(--leaf);box-shadow:0 2px 10px rgba(76,175,114,.2)}
.opt-btn.sel .opt-label{color:var(--canopy)}

.slider-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.slider-val{font-family:'Space Mono',monospace;font-size:22px;font-weight:700;color:var(--canopy)}
.slider-unit{font-size:11px;color:var(--text-muted)}
input[type=range]{width:100%;height:6px;-webkit-appearance:none;appearance:none;background:var(--mist);border-radius:999px;outline:none;cursor:pointer;margin-bottom:16px}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:24px;height:24px;border-radius:50%;background:linear-gradient(135deg,var(--mint),var(--leaf));box-shadow:0 2px 10px rgba(76,175,114,.4);border:2px solid white}

.counter-row{display:flex;align-items:center;gap:14px;margin-bottom:16px}
.count-btn{width:36px;height:36px;border-radius:50%;border:2px solid var(--leaf);background:white;cursor:pointer;font-size:18px;color:var(--canopy);display:flex;align-items:center;justify-content:center;font-weight:700;transition:all .2s}
.count-btn:hover{background:var(--mist)}
.count-num{font-family:'Space Mono',monospace;font-size:28px;font-weight:700;color:var(--canopy);width:40px;text-align:center}

.submit-btn{
  width:calc(100% - 40px);margin:0 20px 24px;
  background:linear-gradient(135deg,var(--leaf),var(--canopy));color:white;
  border:none;border-radius:999px;padding:16px;font-family:'DM Sans',sans-serif;
  font-size:15px;font-weight:700;cursor:pointer;transition:all .2s;
  box-shadow:0 4px 18px rgba(76,175,114,.4);
}
.submit-btn:hover{transform:translateY(-1px);box-shadow:0 6px 24px rgba(76,175,114,.5)}
.submit-btn:active{transform:translateY(0)}

/* ===== RESULT MODAL ===== */
.modal-overlay{
  position:fixed;inset:0;background:rgba(15,31,20,.6);backdrop-filter:blur(6px);
  z-index:100;display:none;align-items:flex-end;justify-content:center;
}
.modal-overlay.open{display:flex}
.modal{
  background:white;border-radius:28px 28px 0 0;padding:28px 24px 40px;
  width:100%;max-width:520px;
  animation:slideUp .4s cubic-bezier(.16,1,.3,1);
}
@keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
.modal-score{
  width:100px;height:100px;border-radius:50%;
  background:linear-gradient(135deg,var(--mint),var(--leaf));
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  margin:0 auto 20px;box-shadow:0 6px 24px rgba(76,175,114,.35);
}
.modal-score-num{font-family:'Space Mono',monospace;font-size:34px;font-weight:700;color:white;line-height:1}
.modal-score-label{font-size:9px;color:rgba(255,255,255,.8);font-weight:600;letter-spacing:.5px;text-transform:uppercase}
.modal-title{font-family:'Fraunces',serif;font-size:22px;font-weight:600;text-align:center;margin-bottom:8px}
.modal-msg{font-size:14px;color:var(--text-muted);text-align:center;line-height:1.6;margin-bottom:20px}
.modal-breakdown{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:20px}
.bd-item{background:var(--mist);border-radius:12px;padding:10px 12px;display:flex;align-items:center;gap:8px}
.bd-emoji{font-size:18px;flex-shrink:0}
.bd-val{font-family:'Space Mono',monospace;font-size:13px;font-weight:700;color:var(--canopy)}
.bd-label{font-size:10px;color:var(--text-muted)}
.modal-btn{width:100%;background:linear-gradient(135deg,var(--leaf),var(--canopy));color:white;border:none;border-radius:999px;padding:14px;font-family:'DM Sans',sans-serif;font-size:14px;font-weight:700;cursor:pointer;box-shadow:0 4px 14px rgba(76,175,114,.3)}

/* ===== NEWS ===== */
.news-card{
  background:white;border-radius:var(--r-lg);margin-bottom:12px;
  border:1px solid var(--border);overflow:hidden;box-shadow:var(--shadow);
}
.news-tag-row{padding:14px 16px 8px;display:flex;align-items:center;gap:8px}
.news-source{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text-muted)}
.news-tag{background:var(--mist);color:var(--canopy);font-size:10px;font-weight:700;padding:3px 8px;border-radius:999px}
.news-title{font-family:'Fraunces',serif;font-size:16px;font-weight:600;padding:0 16px 8px;color:var(--ink);line-height:1.4}
.news-summary{font-size:13px;color:var(--text-muted);padding:0 16px 12px;line-height:1.6}
.news-ai{
  margin:0 16px 16px;
  background:linear-gradient(135deg,#f0fff5,var(--mist));
  border-left:3px solid var(--leaf);padding:10px 12px;border-radius:0 10px 10px 0;
}
.news-ai-label{font-size:10px;font-weight:700;color:var(--canopy);margin-bottom:3px;text-transform:uppercase;letter-spacing:.5px}
.news-ai-text{font-size:12.5px;color:var(--ink);line-height:1.55}
.news-action{padding:0 16px 16px;display:flex;gap:8px;align-items:center}
.action-chip{background:var(--forest);color:var(--mint);font-size:11px;font-weight:600;padding:6px 12px;border-radius:999px;cursor:pointer;transition:all .2s}
.action-chip:hover{background:var(--canopy)}

/* ===== PROFILE ===== */
.profile-hero{
  background:linear-gradient(135deg,var(--forest),var(--canopy));
  padding:40px 24px 32px;text-align:center;
}
.profile-avatar{
  width:80px;height:80px;border-radius:50%;
  background:linear-gradient(135deg,var(--mint),var(--leaf));
  display:flex;align-items:center;justify-content:center;font-size:36px;
  margin:0 auto 14px;box-shadow:0 6px 24px rgba(76,175,114,.4);
}
.profile-name{font-family:'Fraunces',serif;font-size:22px;font-weight:600;color:white}
.profile-school{font-size:13px;color:rgba(255,255,255,.6);margin-top:4px}

.stats-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
.stat-box{background:white;border-radius:var(--r);padding:14px;text-align:center;border:1px solid var(--border)}
.stat-box-val{font-family:'Space Mono',monospace;font-size:20px;font-weight:700;color:var(--canopy)}
.stat-box-label{font-size:10px;color:var(--text-muted);font-weight:500;margin-top:3px;line-height:1.3}

/* ===== BREAKDOWN ===== */
.breakdown-row{display:flex;align-items:center;gap:12px;padding:9px 0;border-bottom:1px solid var(--mist)}
.breakdown-row:last-child{border-bottom:none}
.breakdown-emoji{font-size:20px;width:28px;text-align:center;flex-shrink:0}
.breakdown-label{flex:1;font-size:13px;font-weight:500;color:var(--ink)}
.breakdown-bar{flex:2;height:6px;background:var(--mist);border-radius:999px;overflow:hidden}
.breakdown-fill{height:100%;border-radius:999px;background:linear-gradient(90deg,var(--mint),var(--leaf));transition:width 1s cubic-bezier(.16,1,.3,1)}
.breakdown-val{font-family:'Space Mono',monospace;font-size:11px;font-weight:700;color:var(--canopy);width:50px;text-align:right}

/* ===== PAGE HEADER ===== */
.page-header{padding:28px 24px 0}
.page-title{font-family:'Fraunces',serif;font-size:22px;font-weight:600;color:var(--ink)}
.page-sub{font-size:13px;color:var(--text-muted);margin-top:3px}

/* ===== MOBILE NAV ===== */
.mobile-nav{display:none;position:fixed;bottom:0;left:0;right:0;background:white;border-top:1px solid var(--border);z-index:50;box-shadow:0 -4px 20px rgba(30,90,50,.08);padding-bottom:env(safe-area-inset-bottom)}
.mob-btn{flex:1;border:none;background:transparent;padding:10px 0 8px;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:3px;transition:all .2s}
.mob-icon{font-size:20px;transition:transform .2s}
.mob-label{font-size:9px;font-weight:600;color:var(--text-muted);letter-spacing:.3px}
.mob-btn.active .mob-label{color:var(--canopy)}
.mob-btn.active .mob-icon{transform:translateY(-2px)}
.mob-cta .mob-icon{width:46px;height:46px;background:linear-gradient(135deg,var(--leaf),var(--canopy));border-radius:50%;display:flex;align-items:center;justify-content:center;margin-top:-16px;box-shadow:0 4px 16px rgba(76,175,114,.5);transform:none!important}

@media(max-width:820px){
  .shell{grid-template-columns:1fr}
  .sidebar{display:none}
  .main{padding-bottom:72px}
  .mobile-nav{display:flex}
  .grid-2,.grid-3{grid-template-columns:1fr}
}
@media(min-width:821px){.mobile-nav{display:none!important}}

/* ===== TOAST ===== */
.toast{
  position:fixed;top:20px;right:20px;z-index:200;
  background:var(--ink);color:white;padding:12px 18px;border-radius:12px;
  font-size:13px;font-weight:500;box-shadow:var(--shadow-lg);
  transform:translateY(-60px);opacity:0;transition:all .3s cubic-bezier(.16,1,.3,1);
  max-width:300px;
}
.toast.show{transform:translateY(0);opacity:1}

/* ===== ANALYZE ===== */
.upload-zone{
  border:2px dashed var(--mint);border-radius:var(--r-lg);padding:32px;
  text-align:center;cursor:pointer;transition:all .2s;background:var(--mist);
  margin-bottom:16px;
}
.upload-zone:hover{border-color:var(--leaf);background:#e0f5e8}
.upload-zone input{display:none}
.upload-icon{font-size:36px;display:block;margin-bottom:10px}
.upload-text{font-size:14px;font-weight:600;color:var(--canopy)}
.upload-sub{font-size:12px;color:var(--text-muted);margin-top:4px}

.analyze-result{
  background:white;border-radius:var(--r-lg);padding:20px;
  border:1px solid var(--border);display:none;
}
.analyze-result.show{display:block}
.result-category{
  display:inline-flex;align-items:center;gap:8px;
  background:var(--mist);border:2px solid var(--leaf);border-radius:999px;
  padding:8px 16px;font-weight:700;color:var(--canopy);font-size:14px;margin-bottom:14px;
}